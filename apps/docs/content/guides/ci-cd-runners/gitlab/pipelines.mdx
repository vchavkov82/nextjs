---
title: 'Pipelines'
---

Configure GitLab CI/CD pipelines to use CI/CD Runners.

## Overview

GitLab CI/CD pipelines define build, test, and deployment workflows. CI/CD Runners execute these pipelines on your self-hosted infrastructure.

## Basic Pipeline Configuration

Create a `.gitlab-ci.yml` file in your repository root:

```yaml
stages:
  - build
  - test
  - deploy

build:
  stage: build
  tags:
    - docker
    - linux
  script:
    - echo "Building application"
    - ./build.sh

test:
  stage: test
  tags:
    - docker
    - linux
  script:
    - echo "Running tests"
    - ./test.sh

deploy:
  stage: deploy
  tags:
    - docker
    - linux
  script:
    - echo "Deploying application"
    - ./deploy.sh
  only:
    - main
```

## Using Specific Runners

Target specific runners using tags:

```yaml
build:
  tags:
    - docker
    - linux
    - ci-cd-runner
  script:
    - docker build -t myapp .
```

## Docker Executor

Use Docker executor for containerized builds:

```yaml
build:
  tags:
    - docker
  image: node:18
  script:
    - npm install
    - npm run build
  artifacts:
    paths:
      - dist/
```

## Parallel Jobs

Run jobs in parallel:

```yaml
test:
  tags:
    - docker
  parallel:
    matrix:
      - NODE_VERSION: ["16", "18", "20"]
  image: node:$NODE_VERSION
  script:
    - npm install
    - npm test
```

## Caching

Configure caching for faster builds:

```yaml
cache:
  key: ${CI_COMMIT_REF_SLUG}
  paths:
    - node_modules/
    - .npm/

build:
  tags:
    - docker
  image: node:18
  script:
    - npm ci --cache .npm --prefer-offline
    - npm run build
```

## Artifacts

Define artifacts to pass between stages:

```yaml
build:
  tags:
    - docker
  script:
    - ./build.sh
  artifacts:
    paths:
      - dist/
    expire_in: 1 week

deploy:
  tags:
    - docker
  script:
    - ./deploy.sh
  dependencies:
    - build
```

## Conditional Execution

Run jobs conditionally:

```yaml
deploy:
  tags:
    - docker
  script:
    - ./deploy.sh
  only:
    - main
    - tags
  when: manual
```

## Environment Variables

Use environment variables:

```yaml
build:
  tags:
    - docker
  variables:
    NODE_ENV: production
    BUILD_VERSION: $CI_COMMIT_SHA
  script:
    - echo "Building version $BUILD_VERSION"
    - ./build.sh
```

## Multi-Platform Builds

Build for multiple platforms:

```yaml
build:
  tags:
    - docker
  parallel:
    matrix:
      - PLATFORM: [linux/amd64, linux/arm64]
  script:
    - docker buildx build --platform $PLATFORM -t myapp:$PLATFORM .
```

## Kubernetes Executor

Use Kubernetes executor:

```yaml
build:
  tags:
    - kubernetes
  script:
    - echo "Running on Kubernetes"
    - ./build.sh
```

## Best Practices

- Use tags to target appropriate runners
- Cache dependencies for faster builds
- Use artifacts to share build outputs
- Configure appropriate timeouts
- Use parallel jobs for faster pipelines
- Clean up artifacts when no longer needed
- Use environment variables for configuration

## Advanced Configuration

### Job Templates

Create reusable job templates:

```yaml
.node_template: &node_template
  tags:
    - docker
  image: node:18
  before_script:
    - npm ci --cache .npm --prefer-offline

build:
  <<: *node_template
  script:
    - npm run build

test:
  <<: *node_template
  script:
    - npm test
```

### Dynamic Configuration

Use dynamic configuration for flexibility:

```yaml
variables:
  DOCKER_IMAGE: "alpine:latest"

build:
  tags:
    - docker
  image: $DOCKER_IMAGE
  script:
    - echo "Using $DOCKER_IMAGE"
    - ./build.sh
```

## Troubleshooting

Common issues:

- **Jobs not running**: Check runner tags match job tags
- **Runner unavailable**: Verify runner is online and registered
- **Cache not working**: Check cache configuration and keys
- **Artifacts missing**: Verify artifact paths are correct
- **Timeout errors**: Increase job timeout or optimize scripts
